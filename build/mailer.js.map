{"version":3,"sources":["../server/mailer.js"],"names":["dotenv","config","silent","HOST","process","env","NODE_ENV","from","setup","mailer","createTransport","host","EMAIL_HOST","port","EMAIL_PORT","service","EMAIL_SERVICE","auth","user","MAILJET_API_KEY","pass","MAILJET_API_SECRET","sendConfirmMail","email","token","transport","mail","to","subject","text","console","log","sendMail","err","json"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEAA,iBAAOC,MAAP,CAAc,EAACC,QAAQ,IAAT,EAAd;;AAEA,IAAIC,aAAJ;;AAEA,IAAGC,QAAQC,GAAR,CAAYC,QAAZ,KAAuB,YAA1B,EAAuC;AACrCH,SAAKC,QAAQC,GAAR,CAAYF,IAAjB;AACD,CAFD,MAEO;AACLA,SAAK,uBAAL;AACD;;AAED,IAAMI,0CAAN;;AAEA,IAAMC,QAAQ,SAARA,KAAQ,GAAM;AAClB,SAAOC,qBAAOC,eAAP;AACL;AACE;AACEC,UAAMP,QAAQC,GAAR,CAAYO,UADpB;AAEEC,UAAMT,QAAQC,GAAR,CAAYS,UAFpB;AAGEC,aAASX,QAAQC,GAAR,CAAYW,aAHvB;AAIEC,UAAM;AACJC,YAAMd,QAAQC,GAAR,CAAYc,eADd;AAEJC,YAAMhB,QAAQC,GAAR,CAAYgB;AAFd;AAKV;AATE,GAFG,CAAP;AAaD,CAdD;;AAgBO,IAAMC,4CAAkB,SAAlBA,eAAkB,CAACC,KAAD,EAAOC,KAAP,EAAiB;AAC9C,MAAMC,YAAYjB,OAAlB;AACA,MAAMkB,OAAO;AACXnB,cADW;AAEXoB,QAAIJ,KAFO;AAGXK,aAAS,4CAHE;AAIXC,+FAEI1B,IAFJ,2BAE8BqB,KAF9B;AAJW,GAAb;AASAM,UAAQC,GAAR,CAAe5B,IAAf,sBAAoCqB,KAApC;AACAC,YAAUO,QAAV,CAAmBN,IAAnB,EAAyB,UAACO,GAAD,EAAKC,IAAL,EAAY;AACnC,QAAGD,GAAH,EAAO;AACL,aAAOH,QAAQC,GAAR,CAAYE,GAAZ,CAAP;AACD;AACDH,YAAQC,GAAR,CAAYG,IAAZ;AACD,GALD;AAMD,CAlBM;;AAoBP","file":"mailer.js","sourcesContent":["import mailer from 'nodemailer'\nimport smtp from 'nodemailer-smtp-transport'\nimport dotenv from 'dotenv'\n\ndotenv.config({silent: true})\n\nlet HOST\n\nif(process.env.NODE_ENV==='production'){\n  HOST=process.env.HOST\n} else {\n  HOST='http://localhost:8080'\n}\n\nconst from = `'PiLab' <noreply@lightcharm.co>`\n\nconst setup = () => {\n  return mailer.createTransport(\n    //smtp(\n      {\n        host: process.env.EMAIL_HOST,\n        port: process.env.EMAIL_PORT,\n        service: process.env.EMAIL_SERVICE,\n        auth: {\n          user: process.env.MAILJET_API_KEY,\n          pass: process.env.MAILJET_API_SECRET,\n        }\n      }\n    //)\n  )\n}\n\nexport const sendConfirmMail = (email,token) => {\n  const transport = setup()\n  const mail = {\n    from,\n    to: email,\n    subject: 'Wellcome to Pi-Lab: the best pizza in town',\n    text: `Wellcome Pi,\\n\\nplease click the link to confirm your email...\n    \\n\\n\n      ${HOST}/auth/confirmation/${token}\n    `\n  }\n  console.log(`${HOST}/confirmation/${token}`)\n  transport.sendMail(mail, (err,json)=>{\n    if(err){\n      return console.log(err)\n    }\n    console.log(json)\n  })\n}\n\n/* =============================================== */\n"]}